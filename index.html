<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Empire Logistics: Blood & Deals</title>
<style>
  /* Base Styles */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #0f0f0f;
    color: #eee;
  }
  header {
    background: #1a1a1a;
    padding: 20px;
    font-size: 2em;
    text-align: center;
    color: crimson;
    border-bottom: 3px solid crimson;
  }
  nav {
    display: flex;
    justify-content: space-around;
    background: #111;
    border-bottom: 1px solid #333;
  }
  nav button {
    background: none;
    border: none;
    padding: 15px 25px;
    color: #eee;
    font-size: 1.1em;
    cursor: pointer;
    transition: border-bottom 0.3s;
  }
  nav button.active {
    border-bottom: 3px solid crimson;
    font-weight: bold;
  }
  .screen {
    display: none;
    padding: 20px;
    max-width: 960px;
    margin: auto;
  }
  .screen.active {
    display: block;
  }
  h2 {
    border-bottom: 1px solid crimson;
    padding-bottom: 6px;
  }
  .card {
    background: #1a1a1a;
    margin: 15px 0;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #333;
  }
  button.action-btn {
    background: crimson;
    border: none;
    color: white;
    padding: 8px 14px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 10px;
    transition: background 0.3s;
  }
  button.action-btn:hover {
    background: #b20000;
  }
  select, input[type=number] {
    padding: 5px;
    margin-left: 10px;
    border-radius: 5px;
    border: none;
    font-size: 1em;
  }
  .status-bar {
    margin-top: 15px;
    background: #222;
    padding: 10px;
    border-left: 5px solid crimson;
  }
  .log {
    background: #111;
    margin: 15px 0;
    padding: 10px;
    height: 150px;
    overflow-y: auto;
    font-family: monospace;
    border: 1px solid #333;
    border-radius: 6px;
  }
  .progress-bar {
    height: 20px;
    background: #444;
    border-radius: 10px;
    overflow: hidden;
    margin: 10px 0;
  }
  .progress-fill {
    height: 100%;
    background: crimson;
    width: 0%;
    transition: width 0.5s;
  }
  .disabled {
    opacity: 0.5;
    pointer-events: none;
  }
</style>
</head>
<body>
<header>Empire Logistics: Blood & Deals</header>
<nav>
  <button class="active" onclick="switchScreen('market')">üí∞ Market</button>
  <button onclick="switchScreen('clients')">ü§ù Clients</button>
  <button onclick="switchScreen('police')">üö® Police</button>
  <button onclick="switchScreen('reputation')">üìä Reputation</button>
  <button onclick="switchScreen('logistics')">üöö Logistics</button>
  <button onclick="switchScreen('events')">üî• Events</button>
  <button onclick="switchScreen('loans')">üíµ Loans</button>
  <button onclick="switchScreen('achievements')">üèÜ Achievements</button>
</nav>

<div id="market" class="screen active">
  <h2>Black Market Suppliers</h2>
  <div id="supplier-list"></div>
</div>

<div id="clients" class="screen">
  <h2>Potential Buyers</h2>
  <div id="client-list"></div>
</div>

<div id="police" class="screen">
  <h2>Police Surveillance</h2>
  <div id="police-info"></div>
  <button class="action-btn" onclick="payBribe()">Pay Bribe ($2000)</button>
</div>

<div id="reputation" class="screen">
  <h2>Reputation System</h2>
  <div id="reputation-info"></div>
</div>

<div id="logistics" class="screen">
  <h2>Logistics & Shipping</h2>
  <div class="card">
    <p>Choose Route:
      <select id="route-select">
        <option value="safe">Safe Route (slow)</option>
        <option value="risky">Risky Route (fast)</option>
      </select>
    </p>
    <p>Choose Vehicle:
      <select id="vehicle-select">
        <option value="van">Van</option>
        <option value="armored">Armored Truck</option>
      </select>
    </p>
    <p>Choose Storage:
      <select id="storage-select">
        <option value="internal">Internal Warehouse</option>
        <option value="hidden">Hidden Cellar</option>
      </select>
    </p>
    <p>Quantity to Ship: <input type="number" id="ship-qty" min="1" max="1000" value="10" /></p>
    <button class="action-btn" onclick="startShipping()">Start Shipping</button>
    <div class="status-bar" id="shipping-status"></div>
  </div>
</div>

<div id="events" class="screen">
  <h2>Random Events</h2>
  <div id="events-log" class="log"></div>
  <button class="action-btn" onclick="triggerRandomEvent()">Trigger Random Event</button>
</div>

<div id="loans" class="screen">
  <h2>Loans & Financing</h2>
  <div id="loan-info" class="card"></div>
  <div class="card">
    <p>Give Loan (locked until stage 2)</p>
    <p>Amount: <input type="number" id="loan-amount" min="1000" max="50000" step="1000" disabled /></p>
    <p>Interest %: <input type="number" id="loan-interest" min="5" max="50" step="1" value="10" disabled /></p>
    <button class="action-btn disabled" id="give-loan-btn" disabled onclick="giveLoan()">Give Loan</button>
  </div>
</div>

<div id="achievements" class="screen">
  <h2>Achievements & Daily Goals</h2>
  <div id="achievements-list"></div>
  <div id="daily-goals"></div>
</div>

<script>
  // Game State Variables
  let money = 10000; // Starting loan from gang
  let loanAmount = 10000;
  let loanInterest = 15; // % per cycle if unpaid
  let loanDueTurns = 10; // turns to pay loan before penalty
  let currentTurn = 1;
  let debtUnpaidTurns = 0;
  let stage = 1;
  let reputation = {
    "Los Huesos": 82,
    "The Butcher": 40,
    "Police": -35,
    "Dark Web": 90
  };
  let suppliers = [
    { id: 'viper', name: 'Viper Luca', price: 500, temperament: 'aggressive', quality: 2, risk: 4 },
    { id: 'drhollow', name: 'Dr. Hollow', price: 300, temperament: 'chaotic', quality: 1, risk: 3 },
    { id: 'crimson', name: 'The Crimson Krew', price: 700, temperament: 'hostile', quality: 3, risk: 2 }
  ];
  let clients = [
    { id: 'butcher', name: 'The Butcher', demand: 100, paymentMethod: 'cash', temperament: 'brutal', loyalty: 50 },
    { id: 'corporacion', name: 'La Corporaci√≥n', demand: 200, paymentMethod: 'monthly', temperament: 'loyal', loyalty: 80 }
  ];
  let policeActivity = [
    { message: "Route 9 under surveillance. Avoid it.", active: true, penaltyTurns: 3 },
    { message: "Officer Delgado offers a bribe for $2000.", active: true }
  ];
  let shippingInProgress = false;
  let shippingTimer = 0;
  let shippingDuration = 0;
  let shippingDetails = null;
  let eventsLog = [];
  let achievements = [];
  let dailyGoals = [];
  
  // Initialize UI
  function init() {
    updateMoneyDisplay();
    renderSuppliers();
    renderClients();
    renderPolice();
    renderReputation();
    renderLoanInfo();
    renderAchievements();
    renderDailyGoals();
  }
  function switchScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
  }
  function updateMoneyDisplay() {
    document.title = `üí∞ ${money} MAD - Empire Logistics`;
  }
  // Render Suppliers List
  function renderSuppliers() {
    const container = document.getElementById('supplier-list');
    container.innerHTML = '';
    suppliers.forEach(s => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${s.name}</h3>
        <p>Price per unit: $${s.price}</p>
        <p>Quality: ${s.quality} | Risk: ${s.risk}</p>
        <button class="action-btn" onclick="negotiateSupplier('${s.id}')">Negotiate</button>
      `;
      container.appendChild(card);
    });
  }
  // Supplier negotiation simple AI logic
  function negotiateSupplier(id) {
    const supplier = suppliers.find(s => s.id === id);
    if (!supplier) return alert("Supplier not found");
    let basePrice = supplier.price;
    let offerPrice = basePrice;
    let msg = `${supplier.name} says: `;
    // simple AI temperament reaction
    switch (supplier.temperament) {
      case 'aggressive':
        offerPrice = Math.floor(basePrice * 1.2);
        msg += `"I don't do discounts easily. Take it or leave it at $${offerPrice}."`;
        break;
      case 'chaotic':
        offerPrice = Math.floor(basePrice * (Math.random() * 0.5 + 1));
        msg += `"Let's see if you're lucky. My price: $${offerPrice}."`;
        break;
      case 'hostile':
        offerPrice = Math.floor(basePrice * 1.5);
        msg += `"If you want this, you pay $${offerPrice} or nothing."`;
        break;
      default:
        msg += `"Price is $${offerPrice}."`;
    }
    alert(msg);
  }
  // Render Clients
  function renderClients() {
    const container = document.getElementById('client-list');
    container.innerHTML = '';
    clients.forEach(c => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${c.name}</h3>
        <p>Demand: ${c.demand} units</p>
        <p>Payment method: ${c.paymentMethod}</p>
        <button class="action-btn" onclick="negotiateClient('${c.id}')">Negotiate</button>
      `;
      container.appendChild(card);
    });
  }
  // Client negotiation simple AI logic
  function negotiateClient(id) {
    const client = clients.find(c => c.id === id);
    if (!client) return alert("Client not found");
    let msg = `${client.name} says: `;
    if (client.temperament === 'brutal') {
      msg += `"You better pay upfront or I take my business elsewhere."`;
    } else if (client.temperament === 'loyal') {
      msg += `"I'm willing to build a long-term relationship if you're reliable."`;
    } else {
      msg += `"Let's talk business."`;
    }
    alert(msg);
  }
  // Render Police Info
  function renderPolice() {
    const container = document.getElementById('police-info');
    container.innerHTML = '';
    policeActivity.forEach(p => {
      if (p.active) {
        const div = document.createElement('div');
        div.className = 'card';
        div.textContent = p.message;
        container.appendChild(div);
      }
    });
  }
  // Pay Bribe to Police
  function payBribe() {
    if (money >= 2000) {
      money -= 2000;
      policeActivity.forEach(p => p.active = false);
      addEventLog("You paid a bribe. Police activities decreased.");
      updateMoneyDisplay();
      renderPolice();
    } else {
      alert("Not enough money to pay bribe!");
    }
  }
  // Render Reputation
  function renderReputation() {
    const container = document.getElementById('reputation-info');
    container.innerHTML = '';
    for (const key in reputation) {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `<strong>${key}</strong>: ${reputation[key]}/100`;
      container.appendChild(div);
    }
  }
  // Shipping Logic
  function startShipping() {
    if (shippingInProgress) return alert("Shipping already in progress.");
    const route = document.getElementById('route-select').value;
    const vehicle = document.getElementById('vehicle-select').value;
    const storage = document.getElementById('storage-select').value;
    const qty = parseInt(document.getElementById('ship-qty').value);
    if (qty <= 0 || qty > 1000) return alert("Invalid quantity.");
    let cost = qty * 400; // base cost per unit simplified
    if (cost > money) return alert("Not enough money for shipping cost.");
    money -= cost;
    updateMoneyDisplay();
    shippingInProgress = true;
    shippingDuration = route === 'safe' ? 15 : 8;
    shippingTimer = shippingDuration;
    shippingDetails = { route, vehicle, storage, qty };
    document.getElementById('shipping-status').textContent = `Shipping started: ${qty} units via ${route} route using ${vehicle}. Time: ${shippingDuration} turns.`;
    addEventLog(`Started shipping ${qty} units via ${route} route with ${vehicle}.`);
    runTurn();
  }
  // Handle Turns & Events
  function runTurn() {
    if (shippingInProgress) {
      shippingTimer--;
      if (shippingTimer <= 0) {
        shippingInProgress = false;
        // Random chance police intercept if risky route
        if (shippingDetails.route === 'risky' && Math.random() < 0.3) {
          addEventLog("üö® Risky shipment intercepted by police! Lost goods and paid fine.");
          money -= 2000;
          reputation.Police -= 10;
          if (money < 0) money = 0;
        } else {
          addEventLog(`‚úÖ Shipment of ${shippingDetails.qty} units arrived safely.`);
          money += shippingDetails.qty * 700; // profit simplified
        }
        updateMoneyDisplay();
        document.getElementById('shipping-status').textContent = "No active shipments.";
        checkLoanStatus();
      } else {
        document.getElementById('shipping-status').textContent = `Shipping in progress... ${shippingTimer} turns left.`;
      }
    }
    currentTurn++;
    updateLoanCountdown();
    updateDailyGoals();
    // Auto trigger random event sometimes
    if (Math.random() < 0.1) triggerRandomEvent();
    setTimeout(runTurn, 3000);
  }
  // Events Log
  function addEventLog(text) {
    eventsLog.unshift(`[Turn ${currentTurn}] ${text}`);
    if (eventsLog.length > 50) eventsLog.pop();
    document.getElementById('events-log').textContent = eventsLog.join('\n');
  }
  // Trigger Random Events
  function triggerRandomEvent() {
    const events = [
      () => { addEventLog("üî• Internal betrayal detected! Lost 500 MAD."); money -= 500; if(money < 0) money=0; },
      () => { addEventLog("üö® Police set up a checkpoint. Shipping speed reduced."); },
      () => { addEventLog("üíÄ Client backed out last minute, lost potential sale."); },
      () => { addEventLog("üß® Found a lucrative deal opportunity!"); money += 2000; }
    ];
    const eventFn = events[Math.floor(Math.random()*events.length)];
    eventFn();
    updateMoneyDisplay();
  }
  // Loan Info Rendering
  function renderLoanInfo() {
    const container = document.getElementById('loan-info');
    container.innerHTML = `
      <p><strong>Current Loan:</strong> ${loanAmount} MAD</p>
      <p><strong>Interest Rate:</strong> ${loanInterest}% per turn unpaid</p>
      <p><strong>Turns to pay:</strong> ${loanDueTurns - debtUnpaidTurns}</p>
      <p><strong>Money:</strong> ${money} MAD</p>
    `;
    // Unlock Give Loan feature at stage 2
    if (stage >= 2) {
      document.getElementById('loan-amount').disabled = false;
      document.getElementById('loan-interest').disabled = false;
      document.getElementById('give-loan-btn').disabled = false;
      document.getElementById('give-loan-btn').classList.remove('disabled');
    }
  }
  // Loan Payment Countdown & Penalties
  function updateLoanCountdown() {
    if (money >= loanAmount) {
      // Player can pay loan anytime (for demo, auto-pay if enough)
      money -= loanAmount;
      loanAmount = 0;
      addEventLog("üí∏ Loan paid off successfully.");
      updateMoneyDisplay();
      renderLoanInfo();
      return;
    }
    debtUnpaidTurns++;
    if (debtUnpaidTurns >= loanDueTurns) {
      // Increase interest
      loanInterest += 5;
      addEventLog(`üî• Loan interest increased to ${loanInterest}% due to late payment!`);
      debtUnpaidTurns = 0;
    }
  }
  // Give Loan to Others (locked initially)
  function giveLoan() {
    const amount = parseInt(document.getElementById('loan-amount').value);
    const interest = parseInt(document.getElementById('loan-interest').value);
    if (isNaN(amount) || amount < 1000) return alert("Enter valid loan amount >= 1000.");
    if (isNaN(interest) || interest < 5) return alert("Interest must be at least 5%.");
    if (money < amount) return alert("Not enough money to give loan.");
    money -= amount;
    addEventLog(`üíº You gave a loan of ${amount} MAD at ${interest}% interest.`);
    updateMoneyDisplay();
  }
  // Achievements & Goals
  function renderAchievements() {
    const container = document.getElementById('achievements-list');
    container.innerHTML = '';
    achievements.forEach(a => {
      const div = document.createElement('div');
      div.className = 'card';
      div.textContent = a;
      container.appendChild(div);
    });
  }
  function renderDailyGoals() {
    const container = document.getElementById('daily-goals');
    container.innerHTML = `<h3>Daily Goals</h3>`;
    dailyGoals.forEach(g => {
      const div = document.createElement('div');
      div.className = 'card';
      div.textContent = g;
      container.appendChild(div);
    });
  }
  function updateDailyGoals() {
    // Example goals update
    if (!dailyGoals.includes("Complete a shipment")) dailyGoals.push("Complete a shipment");
    if (!dailyGoals.includes("Negotiate a deal")) dailyGoals.push("Negotiate a deal");
    renderDailyGoals();
  }
  // Initial setup
  init();
</script>
</body>
</html>
