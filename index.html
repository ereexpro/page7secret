<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>إمبراطورية اللوجستيك: الدم والصفقات</title>
<style>
  /* الأساسيات */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #0f0f0f;
    color: #eee;
    direction: rtl;
  }
  header {
    background: #1a1a1a;
    padding: 20px;
    font-size: 2.5em;
    text-align: center;
    color: crimson;
    border-bottom: 3px solid crimson;
    font-weight: bold;
    letter-spacing: 2px;
  }
  nav {
    display: flex;
    justify-content: space-around;
    background: #111;
    border-bottom: 1px solid #333;
  }
  nav button {
    background: none;
    border: none;
    padding: 15px 25px;
    color: #eee;
    font-size: 1.1em;
    cursor: pointer;
    transition: border-bottom 0.3s;
    font-weight: bold;
  }
  nav button.active {
    border-bottom: 3px solid crimson;
  }
  .screen {
    display: none;
    padding: 20px;
    max-width: 960px;
    margin: auto;
  }
  .screen.active {
    display: block;
  }
  h2 {
    border-bottom: 1px solid crimson;
    padding-bottom: 6px;
  }
  .card {
    background: #1a1a1a;
    margin: 15px 0;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #333;
  }
  button.action-btn {
    background: crimson;
    border: none;
    color: white;
    padding: 8px 14px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 10px;
    transition: background 0.3s;
  }
  button.action-btn:hover {
    background: #b20000;
  }
  select, input[type=number] {
    padding: 5px;
    margin-left: 10px;
    border-radius: 5px;
    border: none;
    font-size: 1em;
  }
  .status-bar {
    margin-top: 15px;
    background: #222;
    padding: 10px;
    border-right: 5px solid crimson;
  }
  .log {
    background: #111;
    margin: 15px 0;
    padding: 10px;
    height: 150px;
    overflow-y: auto;
    font-family: monospace;
    border: 1px solid #333;
    border-radius: 6px;
    text-align: left;
    direction: ltr;
  }
  .progress-bar {
    height: 20px;
    background: #444;
    border-radius: 10px;
    overflow: hidden;
    margin: 10px 0;
  }
  .progress-fill {
    height: 100%;
    background: crimson;
    width: 0%;
    transition: width 0.5s;
  }
  .disabled {
    opacity: 0.5;
    pointer-events: none;
  }
</style>
</head>
<body>
<header>🔥 إمبراطورية اللوجستيك: الدم والصفقات 🔥</header>
<nav>
  <button class="active" onclick="switchScreen('market')">💰 السوق السوداء</button>
  <button onclick="switchScreen('clients')">🤝 العملاء</button>
  <button onclick="switchScreen('police')">🚨 الشرطة</button>
  <button onclick="switchScreen('reputation')">📊 السمعة</button>
  <button onclick="switchScreen('logistics')">🚚 اللوجستيك والشحن</button>
  <button onclick="switchScreen('events')">🔥 الأحداث</button>
  <button onclick="switchScreen('loans')">💵 القروض والتمويل</button>
  <button onclick="switchScreen('achievements')">🏆 الإنجازات والأهداف</button>
</nav>

<div id="market" class="screen active">
  <h2>الموردون في السوق السوداء</h2>
  <div id="supplier-list"></div>
</div>

<div id="clients" class="screen">
  <h2>العملاء المحتملون</h2>
  <div id="client-list"></div>
</div>

<div id="police" class="screen">
  <h2>مراقبة الشرطة</h2>
  <div id="police-info"></div>
  <button class="action-btn" onclick="payBribe()">دفع رشوة (2000 درهم)</button>
</div>

<div id="reputation" class="screen">
  <h2>نظام السمعة</h2>
  <div id="reputation-info"></div>
</div>

<div id="logistics" class="screen">
  <h2>اللوجستيك والشحن</h2>
  <div class="card">
    <p>اختر المسار:
      <select id="route-select">
        <option value="safe">مسار آمن (بطيء)</option>
        <option value="risky">مسار محفوف بالمخاطر (سريع)</option>
      </select>
    </p>
    <p>اختر المركبة:
      <select id="vehicle-select">
        <option value="van">فان</option>
        <option value="armored">شاحنة مدرعة</option>
      </select>
    </p>
    <p>اختر التخزين:
      <select id="storage-select">
        <option value="internal">مستودع داخلي</option>
        <option value="hidden">قبو مخفي</option>
      </select>
    </p>
    <p>كمية الشحن: <input type="number" id="ship-qty" min="1" max="1000" value="10" /></p>
    <button class="action-btn" onclick="startShipping()">ابدأ الشحن</button>
    <div class="status-bar" id="shipping-status"></div>
  </div>
</div>

<div id="events" class="screen">
  <h2>الأحداث العشوائية</h2>
  <div id="events-log" class="log"></div>
  <button class="action-btn" onclick="triggerRandomEvent()">إثارة حدث عشوائي</button>
</div>

<div id="loans" class="screen">
  <h2>القروض والتمويل</h2>
  <div id="loan-info" class="card"></div>
  <div class="card">
    <p>إعطاء قرض (مقفل حتى المرحلة 2)</p>
    <p>المبلغ: <input type="number" id="loan-amount" min="1000" max="50000" step="1000" disabled /></p>
    <p>نسبة الفائدة %: <input type="number" id="loan-interest" min="5" max="50" step="1" value="10" disabled /></p>
    <button class="action-btn disabled" id="give-loan-btn" disabled onclick="giveLoan()">أعط قرض</button>
  </div>
</div>

<div id="achievements" class="screen">
  <h2>الإنجازات والأهداف اليومية</h2>
  <div id="achievements-list"></div>
  <div id="daily-goals"></div>
</div>

<script>
  // حالة اللعبة
  let money = 10000; // قرض البداية من العصابة
  let loanAmount = 10000;
  let loanInterest = 15; // نسبة الفائدة المئوية لكل دورة تأخير
  let loanDueTurns = 10; // عدد الأدوار لسداد القرض قبل الغرامة
  let currentTurn = 1;
  let debtUnpaidTurns = 0;
  let stage = 1;
  let reputation = {
    "Los Huesos": 82,
    "The Butcher": 40,
    "Police": -35,
    "Dark Web": 90
  };
  let suppliers = [
    { id: 'viper', name: 'Viper Luca', price: 500, temperament: 'aggressive', quality: 2, risk: 4 },
    { id: 'drhollow', name: 'Dr. Hollow', price: 300, temperament: 'chaotic', quality: 1, risk: 3 },
    { id: 'crimson', name: 'The Crimson Krew', price: 700, temperament: 'hostile', quality: 3, risk: 2 }
  ];
  let clients = [
    { id: 'butcher', name: 'The Butcher', demand: 100, paymentMethod: 'cash', temperament: 'brutal', loyalty: 50 },
    { id: 'corporacion', name: 'La Corporación', demand: 200, paymentMethod: 'monthly', temperament: 'loyal', loyalty: 80 }
  ];
  let policeActivity = [
    { message: "المسار 9 تحت المراقبة، تجنب المرور منه.", active: true, penaltyTurns: 3 },
    { message: "الضابط ديلغادو يعرض رشوة بقيمة 2000 درهم.", active: true }
  ];
  let shippingInProgress = false;
  let shippingTimer = 0;
  let shippingDuration = 0;
  let shippingDetails = null;
  let eventsLog = [];
  let achievements = [];
  let dailyGoals = [];
  
  // تهيئة واجهة المستخدم
  function init() {
    updateMoneyDisplay();
    renderSuppliers();
    renderClients();
    renderPolice();
    renderReputation();
    renderLoanInfo();
    renderAchievements();
    renderDailyGoals();
  }
  function switchScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
  }
  function updateMoneyDisplay() {
    document.title = `💰 ${money} درهم - إمبراطورية اللوجستيك`;
  }
  // عرض الموردين
  function renderSuppliers() {
    const container = document.getElementById('supplier-list');
    container.innerHTML = '';
    suppliers.forEach(s => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${s.name}</h3>
        <p>السعر للوحدة: $${s.price}</p>
        <p>الجودة: ${s.quality} | المخاطرة: ${s.risk}</p>
        <button class="action-btn" onclick="negotiateSupplier('${s.id}')">تفاوض</button>
      `;
      container.appendChild(card);
    });
  }
  // التفاوض مع المورد - منطق مبسط
  function negotiateSupplier(id) {
    const supplier = suppliers.find(s => s.id === id);
    if (!supplier) return alert("المورد غير موجود");
    let basePrice = supplier.price;
    let offerPrice = basePrice;
    let msg = `${supplier.name} يقول: `;
    switch (supplier.temperament) {
      case 'aggressive':
        offerPrice = Math.floor(basePrice * 1.2);
        msg += `"لا أقدم خصومات بسهولة، هذا سعر $${offerPrice}."`;
        break;
      case 'chaotic':
        offerPrice = Math.floor(basePrice * (Math.random() * 0.5 + 1));
        msg += `"خمن السعر، عرضي هو $${offerPrice}."`;
        break;
      case 'hostile':
        offerPrice = Math.floor(basePrice * 1.5);
        msg += `"إذا تريد البضاعة، تدفع $${offerPrice} أو لا شيء."`;
        break;
      default:
        msg += `"السعر هو $${offerPrice}."`;
    }
    alert(msg);
  }
  // عرض العملاء
  function renderClients() {
    const container = document.getElementById('client-list');
    container.innerHTML = '';
    clients.forEach(c => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <h3>${c.name}</h3>
        <p>الطلب: ${c.demand} وحدة</p>
        <p>طريقة الدفع: ${c.paymentMethod}</p>
        <button class="action-btn" onclick="negotiateClient('${c.id}')">تفاوض</button>
      `;
      container.appendChild(card);
    });
  }
  // التفاوض مع العملاء - منطق مبسط
  function negotiateClient(id) {
    const client = clients.find(c => c.id === id);
    if (!client) return alert("العميل غير موجود");
    let msg = `${client.name} يقول: `;
    if (client.temperament === 'brutal') {
      msg += `"ادفع مقدمًا أو سأذهب لغيرك."`;
    } else if (client.temperament === 'loyal') {
      msg += `"أنا مستعد لعلاقة طويلة الأمد إذا كنت موثوقًا."`;
    } else {
      msg += `"دعنا نتحدث عن العمل."`;
    }
    alert(msg);
  }
  // عرض معلومات الشرطة
  function renderPolice() {
    const container = document.getElementById('police-info');
    container.innerHTML = '';
    policeActivity.forEach(p => {
      if (p.active) {
        const div = document.createElement('div');
        div.className = 'card';
        div.textContent = p.message;
        container.appendChild(div);
      }
    });
  }
  // دفع رشوة للشرطة
  function payBribe() {
    if (money >= 2000) {
      money -= 2000;
      policeActivity.forEach(p => p.active = false);
      addEventLog("دفعت رشوة. انخفضت نشاطات الشرطة.");
      updateMoneyDisplay();
      renderPolice();
    } else {
      alert("ليس لديك ما يكفي من المال لدفع الرشوة!");
    }
  }
  // عرض السمعة
  function renderReputation() {
    const container = document.getElementById('reputation-info');
    container.innerHTML = '';
    for (const key in reputation) {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `<strong>${key}</strong>: ${reputation[key]}/100`;
      container.appendChild(div);
    }
  }
  // الشحن
  function startShipping() {
    if (shippingInProgress) return alert("يوجد شحنة جارية بالفعل.");
    const route = document.getElementById('route-select').value;
    const vehicle = document.getElementById('vehicle-select').value;
    const storage = document.getElementById('storage-select').value;
    const qty = parseInt(document.getElementById('ship-qty').value);
    if (qty <= 0 || qty > 1000) return alert("كمية غير صالحة.");
    let cost = qty * 400; // تكلفة الوحدة تقريبي
    if (cost > money) return alert("لا يوجد مال كافٍ لتغطية تكلفة الشحن.");
    money -= cost;
    updateMoneyDisplay();
    shippingInProgress = true;
    shippingDuration = route === 'safe' ? 15 : 8;
    shippingTimer = shippingDuration;
    shippingDetails = { route, vehicle, storage, qty };
    document.getElementById('shipping-status').textContent = `بدأ الشحن: ${qty} وحدة عبر مسار ${route} باستخدام ${vehicle}. الوقت: ${shippingDuration} دورات.`;
    addEventLog(`بدأ شحن ${qty} وحدة عبر مسار ${route} باستخدام ${vehicle}.`);
    runTurn();
  }
  // إدارة الأدوار والأحداث
  function runTurn() {
    if (shippingInProgress) {
      shippingTimer--;
      if (shippingTimer <= 0) {
        shippingInProgress = false;
        // احتمال أن تعترض الشرطة إذا كان المسار محفوف بالمخاطر
        if (shippingDetails.route === 'risky' && Math.random() < 0.3) {
          addEventLog("🚨 تم اعتراض الشحنة من قبل الشرطة! خسرت البضاعة ودُفعت غرامة.");
          money -= 2000;
          reputation.Police -= 10;
          if (money < 0) money = 0;
        } else {
          addEventLog(`✅ وصلت الشحنة من ${shippingDetails.qty} وحدة بأمان.`);
          money += shippingDetails.qty * 700; // الربح تقديري
        }
        updateMoneyDisplay();
        document.getElementById('shipping-status').textContent = "لا توجد شحنات نشطة.";
        checkLoanStatus();
      } else {
        document.getElementById('shipping-status').textContent = `الشحن جارٍ... تبقى ${shippingTimer} دورات.`;
      }
    }
    currentTurn++;
    updateLoanCountdown();
    updateDailyGoals();
    if (Math.random() < 0.1) triggerRandomEvent();
    setTimeout(runTurn, 3000);
  }
  // سجل الأحداث
  function addEventLog(text) {
    eventsLog.unshift(`[الدور ${currentTurn}] ${text}`);
    if (eventsLog.length > 50) eventsLog.pop();
    document.getElementById('events-log').textContent = eventsLog.join('\n');
  }
  // أحداث عشوائية
  function triggerRandomEvent() {
    const events = [
      () => { addEventLog("🔥 خيانة داخلية! خسرت 500 درهم."); money -= 500; if(money < 0) money=0; },
      () => { addEventLog("🚨 الشرطة نشرت نقاط تفتيش. تم تقليل سرعة الشحن."); },
      () => { addEventLog("💀 تراجع عميل في اللحظة الأخيرة، خسرت صفقة."); },
      () => { addEventLog("🧨 وجدت فرصة صفقة مربحة! ربح 2000 درهم."); money += 2000; }
    ];
    const eventFn = events[Math.floor(Math.random()*events.length)];
    eventFn();
    updateMoneyDisplay();
  }
  // معلومات القرض
  function renderLoanInfo() {
    const container = document.getElementById('loan-info');
    container.innerHTML = `
      <p><strong>القرض الحالي:</strong> ${loanAmount} درهم</p>
      <p><strong>نسبة الفائدة:</strong> ${loanInterest}% لكل دورة تأخير</p>
      <p><strong>الدورات المتبقية للسداد:</strong> ${loanDueTurns - debtUnpaidTurns}</p>
      <p><strong>المال المتوفر:</strong> ${money} درهم</p>
    `;
    if (stage >= 2) {
      document.getElementById('loan-amount').disabled = false;
      document.getElementById('loan-interest').disabled = false;
      document.getElementById('give-loan-btn').disabled = false;
      document.getElementById('give-loan-btn').classList.remove('disabled');
    }
  }
  // تحديث عداد سداد القرض والعقوبات
  function updateLoanCountdown() {
    if (money >= loanAmount && loanAmount > 0) {
      money -= loanAmount;
      loanAmount = 0;
      addEventLog("💸 تم سداد القرض بنجاح.");
      updateMoneyDisplay();
      renderLoanInfo();
      return;
    }
    if(loanAmount > 0){
      debtUnpaidTurns++;
      if (debtUnpaidTurns >= loanDueTurns) {
        loanInterest += 5;
        addEventLog(`🔥 زادت نسبة الفائدة إلى ${loanInterest}% بسبب التأخير في السداد!`);
        debtUnpaidTurns = 0;
      }
    }
  }
  // إعطاء قرض للآخرين (مقفل في البداية)
  function giveLoan() {
    const amount = parseInt(document.getElementById('loan-amount').value);
    const interest = parseInt(document.getElementById('loan-interest').value);
    if (isNaN(amount) || amount < 1000) return alert("أدخل مبلغ قرض صالح >= 1000.");
    if (isNaN(interest) || interest < 5) return alert("يجب أن تكون نسبة الفائدة على الأقل 5%.");
    if (money < amount) return alert("ليس لديك ما يكفي من المال لإعطاء قرض.");
    money -= amount;
    addEventLog(`💼 أعطيت قرضًا بقيمة ${amount} درهم بنسبة فائدة ${interest}%.`);
    updateMoneyDisplay();
  }
  // عرض الإنجازات
  function renderAchievements() {
    const container = document.getElementById('achievements-list');
    container.innerHTML = '';
    achievements.forEach(a => {
      const div = document.createElement('div');
      div.className = 'card';
      div.textContent = a;
      container.appendChild(div);
    });
  }
  // عرض الأهداف اليومية
  function renderDailyGoals() {
    const container = document.getElementById('daily-goals');
    container.innerHTML = `<h3>الأهداف اليومية</h3>`;
    dailyGoals.forEach(g => {
      const div = document.createElement('div');
      div.className = 'card';
      div.textContent = g;
      container.appendChild(div);
    });
  }
  // تحديث الأهداف اليومية
  function updateDailyGoals() {
    if (!dailyGoals.includes("إتمام شحنة")) dailyGoals.push("إتمام شحنة");
    if (!dailyGoals.includes("التفاوض على صفقة")) dailyGoals.push("التفاوض على صفقة");
    renderDailyGoals();
  }
  // تحقق حالة القرض (مؤقت)
  function checkLoanStatus() {
    // هنا يمكن إضافة منطق متقدم
  }
  // بدء اللعبة
  init();
</script>
</body>
</html>
